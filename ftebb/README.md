
## FiveThirtyEight baseball riddler

This repo includes code to solve the baseball oriented puzzle from FiveThirtyEight's Riddler for [Sept 27, 2019](https://fivethirtyeight.com/features/which-baseball-team-will-win-the-riddler-fall-classic/)

In this puzzle there are 3 teams.

* Moonwalkers

* Doubloons

* Taters

The three teams always either strikeout or (walk, hit doubles, hit homeruns), respectively. The probabilities for success are (0.4, 0.2, 0.1), respectively, i.e. the average number of bases obtained is 0.4 in each case. The question is, which team is most likely to win the league if the three teams play an equal number of games against each other.

### ftebb.py (Five Thirty Eight BaseBall)

This code computes exact probability distributions for runs scored, using the negative binomial distribution.

### bbnbinom.py (BaseBall with NegativeBinomial)

This code use numerical simulations. 

### Results

The exact computations from `ftebb.py` are more precise, as well as being computationally faster, and so are more interesting to examine. 

### Taters vs Doubloons 

The Taters win 62.7% of the time

```
$ python ./ftebb.py --success-prob 0.1 0.2 --offset 0 1 
    innings      tie_prob  win_prob  loss_prob  relative_prob
0         9  1.503555e-01  0.535313   0.314332       0.630043
1        10  9.411589e-02  0.569714   0.336170       0.628904
2        11  5.891238e-02  0.591247   0.349840       0.628259
3        12  3.687654e-02  0.604726   0.358397       0.627880
4        13  2.308308e-02  0.613163   0.363754       0.627651
5        14  1.444899e-02  0.618445   0.367106       0.627512
6        15  9.044427e-03  0.621751   0.369205       0.627425
7        16  5.661411e-03  0.623820   0.370519       0.627372
8        17  3.543793e-03  0.625115   0.371341       0.627338
9        18  2.218257e-03  0.625926   0.371856       0.627318
10       19  1.388531e-03  0.626434   0.372178       0.627305
11       20  8.691588e-04  0.626751   0.372380       0.627296
12       21  5.440550e-04  0.626950   0.372506       0.627291
13       22  3.405543e-04  0.627075   0.372585       0.627288
14       23  2.131719e-04  0.627153   0.372634       0.627286
15       24  1.334362e-04  0.627201   0.372665       0.627285
16       25  8.352515e-05  0.627232   0.372685       0.627284
17       26  5.228305e-05  0.627251   0.372697       0.627284
18       27  3.272687e-05  0.627263   0.372704       0.627283
19       28  2.048557e-05  0.627270   0.372709       0.627283
20       29  1.282306e-05  0.627275   0.372712       0.627283
21       30  8.026669e-06  0.627278   0.372714       0.627283
22       31  5.024340e-06  0.627280   0.372715       0.627283
23       32  3.145014e-06  0.627281   0.372716       0.627283
24       33  1.968640e-06  0.627282   0.372716       0.627283
25       34  1.232281e-06  0.627282   0.372717       0.627283
26       35  7.713536e-07  0.627282   0.372717       0.627283
```

### Moonwalkers vs Doubloons 

The Moonwalkers win 58.5% of the time
```
$ python ./ftebb.py --success-prob 0.4 0.2 --offset 3 1 
    innings      tie_prob  win_prob  loss_prob  relative_prob
0         9  1.345929e-01  0.516078   0.349319       0.596348
1        10  9.217582e-02  0.537751   0.370064       0.592358
2        11  6.312652e-02  0.552593   0.384270       0.589833
3        12  4.323213e-02  0.562758   0.394000       0.588193
4        13  2.960748e-02  0.569720   0.400663       0.587108
5        14  2.027665e-02  0.574487   0.405226       0.586383
6        15  1.388644e-02  0.577752   0.408352       0.585894
7        16  9.510117e-03  0.579988   0.410492       0.585563
8        17  6.512994e-03  0.581520   0.411958       0.585338
9        18  4.460417e-03  0.582568   0.412961       0.585184
10       19  3.054712e-03  0.583287   0.413649       0.585080
11       20  2.092017e-03  0.583779   0.414120       0.585008
12       21  1.432715e-03  0.584115   0.414442       0.584959
13       22  9.811937e-04  0.584346   0.414663       0.584926
14       23  6.719695e-04  0.584504   0.414814       0.584903
15       24  4.601976e-04  0.584612   0.414918       0.584887
16       25  3.151659e-04  0.584686   0.414989       0.584876
17       26  2.158410e-04  0.584737   0.415037       0.584869
18       27  1.478185e-04  0.584772   0.415070       0.584864
19       28  1.012333e-04  0.584796   0.415093       0.584861
20       29  6.932955e-05  0.584812   0.415109       0.584858
21       30  4.748027e-05  0.584823   0.415120       0.584857
22       31  3.251682e-05  0.584831   0.415127       0.584856
23       32  2.226911e-05  0.584836   0.415132       0.584855
24       33  1.525098e-05  0.584840   0.415135       0.584854
25       34  1.044462e-05  0.584842   0.415138       0.584854
26       35  7.152984e-06  0.584844   0.415139       0.584854
27       36  4.898714e-06  0.584845   0.415140       0.584854
28       37  3.354879e-06  0.584846   0.415141       0.584853
29       38  2.297586e-06  0.584846   0.415142       0.584853
30       39  1.573499e-06  0.584847   0.415142       0.584853
31       40  1.077609e-06  0.584847   0.415142       0.584853
32       41  7.379996e-07  0.584847   0.415142       0.584853
```

### Moonwalkers vs Taters

The real interesting matchup is the Moonwalkers vs the Taters. The Moonwalkers have more runs scored on average, but also a higher probability to have 0 runs. This of course means they have a higher probability for big innings also, i.e. they have a high variance. 

This means the Taters do better in short games. For this reason, if the game goes to extra innings they're lilely to win. 

In a game with 9-innings at baseline, they still win the majority of the time, namely 51.6% of the time

```
$ python ./ftebb.py --success-prob 0.1 0.4 --offset 0 3
    innings      tie_prob  win_prob  loss_prob  relative_prob
0         9  1.245193e-01  0.441938   0.433533       0.504800
1        10  7.704385e-02  0.470229   0.452717       0.509487
2        11  4.766936e-02  0.487734   0.464587       0.512153
3        12  2.949448e-02  0.498565   0.471931       0.513722
4        13  1.824913e-02  0.505266   0.476475       0.514663
5        14  1.129129e-02  0.509413   0.479286       0.515235
6        15  6.986261e-03  0.511978   0.481026       0.515585
7        16  4.322611e-03  0.513565   0.482102       0.515800
8        17  2.674531e-03  0.514548   0.482768       0.515932
9        18  1.654813e-03  0.515155   0.483180       0.516014
10       19  1.023883e-03  0.515531   0.483435       0.516065
11       20  6.335074e-04  0.515764   0.483593       0.516096
12       21  3.919702e-04  0.515908   0.483691       0.516115
13       22  2.425238e-04  0.515997   0.483751       0.516127
14       23  1.500568e-04  0.516052   0.483788       0.516134
15       24  9.284471e-05  0.516086   0.483811       0.516139
16       25  5.744584e-05  0.516107   0.483826       0.516142
17       26  3.554348e-05  0.516120   0.483835       0.516144
18       27  2.199183e-05  0.516128   0.483840       0.516145
19       28  1.360701e-05  0.516133   0.483843       0.516145
20       29  8.419068e-06  0.516136   0.483846       0.516146
21       30  5.209133e-06  0.516138   0.483847       0.516146
22       31  3.223048e-06  0.516139   0.483848       0.516146
23       32  1.994197e-06  0.516140   0.483848       0.516146
24       33  1.233870e-06  0.516141   0.483848       0.516146
25       34  7.634330e-07  0.516141   0.483849       0.516146
```

However, if games were 13 innings long than the Moonwalkers would win 50.3% of the time

```
$ python ./ftebb.py --success-prob 0.1 0.4 --offset 0 3 --baseline-innings 13
    innings      tie_prob  win_prob  loss_prob  relative_prob
0        13  1.005632e-01  0.437035   0.462381       0.485910
1        14  6.222149e-02  0.459884   0.477874       0.490408
2        15  3.849832e-02  0.474021   0.487460       0.493011
3        16  2.382008e-02  0.482768   0.493391       0.494559
4        17  1.473820e-02  0.488180   0.497061       0.495493
5        18  9.118973e-03  0.491529   0.499331       0.496063
6        19  5.642185e-03  0.493601   0.500736       0.496412
7        20  3.490990e-03  0.494883   0.501606       0.496627
8        21  2.159982e-03  0.495676   0.502143       0.496759
9        22  1.336446e-03  0.496167   0.502476       0.496841
10       23  8.268996e-04  0.496470   0.502682       0.496891
11       24  5.116278e-04  0.496658   0.502809       0.496923
12       25  3.165596e-04  0.496774   0.502888       0.496942
13       26  1.958650e-04  0.496846   0.502937       0.496954
14       27  1.211876e-04  0.496891   0.502967       0.496961
15       28  7.498245e-05  0.496918   0.502986       0.496966
16       29  4.639391e-05  0.496935   0.502997       0.496969
17       30  2.870532e-05  0.496946   0.503005       0.496970
18       31  1.776085e-05  0.496952   0.503009       0.496972
19       32  1.098918e-05  0.496956   0.503012       0.496972
20       33  6.799336e-06  0.496959   0.503013       0.496973
21       34  4.206955e-06  0.496960   0.503015       0.496973
22       35  2.602971e-06  0.496961   0.503015       0.496973
23       36  1.610537e-06  0.496962   0.503016       0.496973
24       37  9.964878e-07  0.496962   0.503016       0.496973
```

And if games had a 10-inning baseline, the Moonwalkers would be more likely to win in games that end after regulation, but more likely to lose overall due to extra inning games.

```
$ python ./ftebb.py --success-prob 0.1 0.4 --offset 0 3 --baseline-innings 10
    innings      tie_prob  win_prob  loss_prob  relative_prob
0        10  1.168322e-01  0.440927   0.442229       0.499263
1        11  7.228763e-02  0.467472   0.460229       0.503904
2        12  4.472655e-02  0.483897   0.471366       0.506559
3        13  2.767367e-02  0.494059   0.478256       0.508126
4        14  1.712254e-02  0.500346   0.482520       0.509069
5        15  1.059423e-02  0.504237   0.485158       0.509642
6        16  6.554972e-03  0.506644   0.486790       0.509993
7        17  4.055760e-03  0.508133   0.487800       0.510208
8        18  2.509421e-03  0.509055   0.488425       0.510341
9        19  1.552655e-03  0.509625   0.488811       0.510423
10       20  9.606747e-04  0.509978   0.489050       0.510474
11       21  5.943985e-04  0.510196   0.489198       0.510505
12       22  3.677724e-04  0.510331   0.489290       0.510525
13       23  2.275519e-04  0.510415   0.489347       0.510536
14       24  1.407932e-04  0.510466   0.489382       0.510544
15       25  8.711305e-05  0.510498   0.489403       0.510548
16       26  5.389948e-05  0.510518   0.489417       0.510551
17       27  3.334924e-05  0.510530   0.489425       0.510553
18       28  2.063418e-05  0.510538   0.489430       0.510554
19       29  1.276699e-05  0.510543   0.489433       0.510555
20       30  7.899326e-06  0.510545   0.489435       0.510555
21       31  4.887552e-06  0.510547   0.489437       0.510555
22       32  3.024077e-06  0.510548   0.489437       0.510556
23       33  1.871088e-06  0.510549   0.489438       0.510556
24       34  1.157699e-06  0.510549   0.489438       0.510556
25       35  7.163032e-07  0.510550   0.489438       0.510556
```